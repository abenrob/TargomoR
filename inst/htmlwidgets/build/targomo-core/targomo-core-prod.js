!function(t){var e={};function i(n){if(e[n])return e[n].exports;var r=e[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var r in t)i.d(n,r,function(e){return t[e]}.bind(null,r));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){!function(t){"use strict";!function(t){if(!t.fetch){var e="URLSearchParams"in t,i="Symbol"in t&&"iterator"in Symbol,n="FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),r="FormData"in t,s="ArrayBuffer"in t;if(s)var o=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],a=function(t){return t&&DataView.prototype.isPrototypeOf(t)},c=ArrayBuffer.isView||function(t){return t&&-1<o.indexOf(Object.prototype.toString.call(t))};p.prototype.append=function(t,e){t=h(t),e=f(e);var i=this.map[t];this.map[t]=i?i+","+e:e},p.prototype.delete=function(t){delete this.map[h(t)]},p.prototype.get=function(t){return t=h(t),this.has(t)?this.map[t]:null},p.prototype.has=function(t){return this.map.hasOwnProperty(h(t))},p.prototype.set=function(t,e){this.map[h(t)]=f(e)},p.prototype.forEach=function(t,e){for(var i in this.map)this.map.hasOwnProperty(i)&&t.call(e,this.map[i],i,this)},p.prototype.keys=function(){var t=[];return this.forEach(function(e,i){t.push(i)}),d(t)},p.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),d(t)},p.prototype.entries=function(){var t=[];return this.forEach(function(e,i){t.push([i,e])}),d(t)},i&&(p.prototype[Symbol.iterator]=p.prototype.entries);var u=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];T.prototype.clone=function(){return new T(this,{body:this._bodyInit})},b.call(T.prototype),b.call(w.prototype),w.prototype.clone=function(){return new w(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new p(this.headers),url:this.url})},w.error=function(){var t=new w(null,{status:0,statusText:""});return t.type="error",t};var l=[301,302,303,307,308];w.redirect=function(t,e){if(-1===l.indexOf(e))throw new RangeError("Invalid status code");return new w(null,{status:e,headers:{location:t}})},t.Headers=p,t.Request=T,t.Response=w,t.fetch=function(t,e){return new Promise(function(i,r){var s=new T(t,e),o=new XMLHttpRequest;o.onload=function(){var t,e,n={status:o.status,statusText:o.statusText,headers:(t=o.getAllResponseHeaders()||"",e=new p,t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var i=t.split(":"),n=i.shift().trim();if(n){var r=i.join(":").trim();e.append(n,r)}}),e)};n.url="responseURL"in o?o.responseURL:n.headers.get("X-Request-URL");var r="response"in o?o.response:o.responseText;i(new w(r,n))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(s.method,s.url,!0),"include"===s.credentials?o.withCredentials=!0:"omit"===s.credentials&&(o.withCredentials=!1),"responseType"in o&&n&&(o.responseType="blob"),s.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send(void 0===s._bodyInit?null:s._bodyInit)})},t.fetch.polyfill=!0}function h(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function f(t){return"string"!=typeof t&&(t=String(t)),t}function d(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return i&&(e[Symbol.iterator]=function(){return e}),e}function p(t){this.map={},t instanceof p?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function g(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function m(t){return new Promise(function(e,i){t.onload=function(){e(t.result)},t.onerror=function(){i(t.error)}})}function v(t){var e=new FileReader,i=m(e);return e.readAsArrayBuffer(t),i}function y(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function b(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t)if("string"==typeof t)this._bodyText=t;else if(n&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(r&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(e&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(s&&n&&a(t))this._bodyArrayBuffer=y(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!s||!ArrayBuffer.prototype.isPrototypeOf(t)&&!c(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=y(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):e&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},n&&(this.blob=function(){var t=g(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?g(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(v)}),this.text=function(){var t,e,i,n=g(this);if(n)return n;if(this._bodyBlob)return t=this._bodyBlob,e=new FileReader,i=m(e),e.readAsText(t),i;if(this._bodyArrayBuffer)return Promise.resolve(function(t){for(var e=new Uint8Array(t),i=new Array(e.length),n=0;n<e.length;n++)i[n]=String.fromCharCode(e[n]);return i.join("")}(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},r&&(this.formData=function(){return this.text().then(S)}),this.json=function(){return this.text().then(JSON.parse)},this}function T(t,e){var i,n,r=(e=e||{}).body;if(t instanceof T){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new p(t.headers)),this.method=t.method,this.mode=t.mode,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new p(e.headers)),this.method=(i=e.method||this.method||"GET",n=i.toUpperCase(),-1<u.indexOf(n)?n:i),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function S(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var i=t.split("="),n=i.shift().replace(/\+/g," "),r=i.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(r))}}),e}function w(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=200<=this.status&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new p(e.headers),this.url=e.url||"",this._initBody(t)}}("undefined"!=typeof self?self:window);var e=function(t){this.serverUrl="https://api.targomo.com",this.statisticsUrl="https://api.targomo.com/statistics",this.tilesUrl="https://api.targomo.com/vector-statistics",this.poiUrl="https://api.targomo.com/pointofinterest",this.mapTilesUrl="https://maps.targomo.com",this.photonGeocoderUrl="https://api.targomo.com/geocode",this.overpassUrl="https://api.targomo.com/overpass",this.fleetsUrl="https://api.targomo.com/fleetplanner",Object.assign(this,t)},i=function(t,e){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)};function n(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}var r=function(){return(r=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)};function s(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{c(n.next(t))}catch(t){s(t)}}function a(t){try{c(n.throw(t))}catch(t){s(t)}}function c(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(o,a)}c((n=n.apply(t,e||[])).next())})}function o(t,e){var i,n,r,s,o={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(i)throw new TypeError("Generator is already executing.");for(;o;)try{if(i=1,n&&(r=2&s[0]?n.return:s[0]?n.throw||((r=n.return)&&r.call(n),0):n.next)&&!(r=r.call(n,s[1])).done)return r;switch(n=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,n=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(r=0<(r=o.trys).length&&r[r.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){o.label=s[1];break}if(6===s[0]&&o.label<r[1]){o.label=r[1],r=s;break}if(r&&o.label<r[2]){o.label=r[2],o.ops.push(s);break}r[2]&&o.ops.pop(),o.trys.pop();continue}s=e.call(t,o)}catch(t){s=[6,t],n=0}finally{i=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}var a=function(t,e,i,n){this.value=t,this.key=e,this.previous=i,this.next=n},c=function(){function t(t){void 0===t&&(t=0),this.capacity=t,this.map={},this.size=0}return t.prototype.get=function(t,e){return s(this,void 0,void 0,function(){var i,n,r,s,c;return o(this,function(o){switch(o.label){case 0:if(void 0===(i=this.map[t]))return[3,5];this.oldest==i&&i.next&&(this.oldest=i.next),i.next&&(i.next.previous=i.previous),i.previous&&(i.previous.next=i.next),i.previous=this.newest,i.next=null,this.newest=i,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,i.value];case 2:return[2,o.sent()];case 3:return o.sent(),this.map[t]=void 0,[2,this.get(t,e)];case 4:return[3,8];case 5:return e?(n=e(),r=this.map[t]=new a(n,t,this.newest,null),[4,n]):[3,7];case 6:return s=o.sent(),this.newest&&(this.newest.next=r),this.newest=r,this.capacity&&(this.size>=this.capacity?(c=this.oldest)&&(this.oldest=c.next,delete this.map[c.key]):this.size++),this.oldest||(this.oldest=this.newest),[2,s];case 7:return[2,void 0];case 8:return[2]}})})},t}(),u=function(){function t(){this.map={}}return t.prototype.get=function(t,e){return s(this,void 0,void 0,function(){var i,n;return o(this,function(r){switch(r.label){case 0:return i="string"==typeof t?t:JSON.stringify(t),null==this.map[i]?[3,1]:[2,this.map[i]];case 1:return[4,e()];case 2:return n=r.sent(),[2,this.map[i]=n]}})})},t}(),l=new u,h=function(){function t(){}return t.prototype.fetch=function(t,e,i,n){return void 0===e&&(e="GET"),void 0===n&&(n={}),s(this,void 0,void 0,function(){var r,s,a,c,u,l,h,f,d,p;return o(this,function(o){switch(o.label){case 0:return"JSONP"!==(r=e)?n.Accept=n.Accept?n.Accept:"application/json":r="GET","POST-RAW"===e&&(r="POST"),"PUT"!==r&&"POST"!==r||(n["Content-Type"]="application/json"),s={method:r,headers:new Headers(n)},"POST-RAW"===e?s.body=i:"GET"!==e&&"JSONP"!==e&&(s.body=JSON.stringify(i)),[4,fetch(t,s)];case 1:return 400<=(a=o.sent()).status?"application/json"!==a.headers.get("content-type")?[3,3]:(h=(l=JSON).stringify,[4,a.text()]):[3,6];case 2:return u=h.apply(l,[o.sent(),null,2]),[3,5];case 3:return[4,a.text()];case 4:u=o.sent(),o.label=5;case 5:throw c=u,console.error("[ERROR] in service request\n      status  = "+a.status+" "+a.statusText+"\n      url     = "+t+"\n      body    = "+c),new Error(c);case 6:return"JSONP"!==e?[3,8]:[4,a.text()];case 7:return f=o.sent(),d=f.indexOf("("),p=f.lastIndexOf(")"),-1<d&&-1<p?[2,JSON.parse(f.substring(d+1,p))]:[2,JSON.parse(f)];case 8:return[2,a.json()];case 9:return[2]}})})},t.prototype.fetchData=function(t,e,i,n){return void 0===e&&(e="GET"),s(this,void 0,void 0,function(){var r;return o(this,function(s){switch(s.label){case 0:return[4,this.fetch(t,e,i,n)];case 1:return(r=s.sent()).data?[2,r.data]:(console.warn("No data object was transmitted by "+t+" \nReturning raw response"),[2,r])}})})},t.prototype.fetchCached=function(t,e,i,n,r){var s=this;if(void 0===i&&(i="GET"),!1===t)return this.fetch(e,i,n,r);!0!==t&&t||(t=l);var o=JSON.stringify({url:e,method:i,payload:n});return t.get(o,function(){return s.fetch(e,i,n,r)})},t.prototype.fetchCachedData=function(t,e,i,n,r){var s=this;if(void 0===i&&(i="GET"),!1===t)return this.fetchData(e,i,n,r);!0!==t&&t||(t=l);var o=JSON.stringify({url:e,method:i,payload:n});return t.get(o,function(){return s.fetchData(e,i,n,r)})},t}();function f(t,e){return new h}var d,p=function(){function t(t){this.client=t}return t.prototype.fetch=function(t,e,i){return s(this,void 0,void 0,function(){var n,r,s;return o(this,function(o){switch(o.label){case 0:return n={west:i.southWest.lng,south:i.southWest.lat,east:i.northEast.lng,north:i.northEast.lat},r={bounds:n,benchmarks:e.map(function(t){return{source:t.source,minEnd:t.minEnd,minStart:t.minStart,factor:t.factor}})},s=this.client.config.tilesUrl+"/benchmarks/scores_cumulative/v1/"+encodeURIComponent(""+t)+"?key="+encodeURIComponent(this.client.serviceKey),[4,f(this.client).fetch(s,"POST",r)];case 1:return[2,o.sent()]}})})},t.prototype.metadata=function(t){return s(this,void 0,void 0,function(){var e;return o(this,function(i){switch(i.label){case 0:return e=this.client.config.tilesUrl+"/benchmarks/meta/v1/"+encodeURIComponent(""+t)+"?key="+encodeURIComponent(this.client.serviceKey),[4,f(this.client).fetch(e)];case 1:return[2,i.sent()]}})})},t}();(d=t.UrlUtil||(t.UrlUtil={})).queryToString=function(t){var e=[];for(var i in t){var n=t[i];void 0!==n&&e.push(i+"="+encodeURIComponent(n))}return e.join("&")},d.buildTargomoUrl=function(t,e,i,n){return void 0===n&&(n=!0),"/"!==t[t.length-1]&&(t+="/"),t+(n?"v1/":"")+e+"?key="+i};var g=function(){function e(){}return e.prototype.geocode=function(e,i,n,r,a){return s(this,void 0,void 0,function(){var n,s;return o(this,function(o){switch(o.label){case 0:return n={singleLine:e,f:"json",countryCode:r,maxLocations:5},i&&(n.location=i.lng+","+i.lat),a&&(n.magicKey=a),s="https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/findAddressCandidates?"+t.UrlUtil.queryToString(n),[4,f().fetch(s)];case 1:return[2,o.sent().candidates.map(function(t){return{lat:t.location.y,lng:t.location.x,description:t.address}})]}})})},e.prototype.suggest=function(e,i,n,r,a){return void 0===a&&(a=5),s(this,void 0,void 0,function(){var n;return o(this,function(s){switch(s.label){case 0:return n={text:e,f:"json",countryCode:r,maxSuggestions:a},i&&(n.location=i.lng+","+i.lat),[4,f().fetch("https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/suggest?"+t.UrlUtil.queryToString(n))];case 1:return[2,s.sent().suggestions]}})})},e.prototype.reverseGeocode=function(e,i){return s(this,void 0,void 0,function(){var i,n;return o(this,function(r){switch(r.label){case 0:return(i={f:"json"}).location=e.lng+","+e.lat,[4,f().fetch("https://geocode.arcgis.com/arcgis/rest/services/World/GeocodeServer/reverseGeocode?"+t.UrlUtil.queryToString(i))];case 1:return(n=r.sent())&&n.address?[2,{address:n.address.Match_addr,city:n.address.City,countryCode:n.address.CountryCode,location:n.address.Loc_name,region:n.address.Region,subregion:n.address.Subregion,zip:n.address.Postal}]:[2,{}]}})})},e}(),m=function(){function t(t){this.client=t}return t.prototype.geocode=function(t,e,i){return s(this,void 0,void 0,function(){var n,r,s,a=this;return o(this,function(o){switch(o.label){case 0:return n=this.client.config.photonGeocoderUrl,r=n+"/api/?q="+encodeURIComponent(t)+"&limit=5",e&&(r+="&lat="+e.lat+"&lon="+e.lng),i&&(r+="&lang="+encodeURIComponent(i)),[4,f().fetch(r)];case 1:return(s=o.sent()).features.forEach(function(t,e,i){"boundary"==t.properties.osm_key&&i.splice(e,1)}),[2,s.features.map(function(t){return t.value=t.properties.osm_id,t.description=a.buildPlaceDescription(t.properties),t})]}})})},t.prototype.buildPlaceDescription=function(t){var e=function(t,e){return void 0===e&&(e=" "),t.filter(function(t){return!!t}).join(e).trim()},i=function(i,n){return e(i.map(function(e){return t[e]}),n)},n=i(["street","housenumber"]," "),r=e([i(["postcode","city"]," "),t.country],", "),s={title:"",meta1:"",meta2:"",full:""};return void 0!==t.name?(s.title=t.name,s.meta1=n,s.meta2=r):(s.title=n,s.meta1=r),t.name!==n&&(s.full=s.title),s.meta1&&t.name!==n&&(s.full+=", "+s.meta1),s.meta1&&t.name===n&&(s.full+=s.meta1),s.full=e([s.full,s.meta2],", "),s},t}(),v=function(){this.edgeWeight="time"},y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.transitFrameDuration=void 0,e.transitFrameDate=20170801,e.transitFrameTime=39600,e.transitMaxTransfers=5,e.walkSpeed={},e.bikeSpeed={},e}return n(e,t),e}(v),b=function(t){function e(e){var i=t.call(this)||this;if(Object.assign(i,e),null!=e.transitFrameDateTime){var n=void 0,r=(n=e.transitFrameDateTime instanceof Date?e.transitFrameDateTime:new Date(e.transitFrameDateTime))?1e4*n.getFullYear()+100*(n.getMonth()+1)+n.getDate():void 0,s=n?3600*n.getHours()+60*n.getMinutes():void 0;i.transitFrameDate=r||i.transitFrameDate,i.transitFrameTime=s||i.transitFrameTime}return i}return n(e,t),e.prototype.buildTargetsCfg=function(t){return t.map(function(t){return{lat:t.lat,lng:t.lng,id:t.id}})},e.prototype.buildSourcesCfg=function(t){var e=this;return t.map(function(t){var i={lat:t.lat,lng:t.lng,id:t.id,tm:t.tm};if(!i.tm)switch(e.travelType){case"car":i.tm={car:e.rushHour?{rushHour:e.rushHour}:{}};break;case"walk":i.tm={walk:e.walkSpeed};break;case"bike":i.tm={bike:e.bikeSpeed};break;case"transit":i.tm={transit:{frame:{date:e.transitFrameDate,time:e.transitFrameTime,duration:e.transitFrameDuration},maxTransfers:e.transitMaxTransfers}}}return i})},e}(y),T=function(t){function e(e,i,n){var r=t.call(this,i)||this;return r.sources=r.buildSourcesCfg(e),n&&(r.targets=r.buildTargetsCfg(n)),r.multigraph=i.multigraph,r}return n(e,t),e}(b),S=function(){function e(t){this.client=t}return e.prototype.fetch=function(e,i,n){return s(this,void 0,void 0,function(){var r,s;return o(this,function(o){switch(o.label){case 0:return r=t.UrlUtil.buildTargomoUrl(this.client.serviceUrl,"multigraph",this.client.serviceKey,!0),s=new T(e,i,n),[4,f(this.client).fetch(r,"POST",s)];case 1:return[2,o.sent()]}})})},e.prototype.fetchOverview=function(e,i,n){return s(this,void 0,void 0,function(){var r,s;return o(this,function(o){switch(o.label){case 0:return r=t.UrlUtil.buildTargomoUrl(this.client.serviceUrl,"multigraph/overview",this.client.serviceKey,!0),s=new T(e,i,n),[4,f(this.client).fetch(r,"POST",s)];case 1:return[2,o.sent()]}})})},e.prototype.getTiledMultigraphUrl=function(e,i,n,r){return s(this,void 0,void 0,function(){var s,a,c;return o(this,function(o){switch(o.label){case 0:return s=t.UrlUtil.buildTargomoUrl(this.client.serviceUrl,"objectcache/add",this.client.serviceKey,!0),a=new T(e,i,r),[4,f(this.client).fetch(s,"POST",a)];case 1:return c=o.sent(),[2,this.client.serviceUrl+"v1/multigraph/{z}/{x}/{y}."+n+"?key="+this.client.serviceKey+"&cfgUuid="+c.uuid]}})})},e}(),w=function(t,e,i,n){this.description=n.description||"",this.serviceUrl=t,this.serviceKey=e,this.email=n.email||"developers@targomo.com",this.sendMail=!1,this.callbackUrl=n.callbackUrl||"https://localhost/",this.pointsPerSolution=n.pointsPerSolution,this.maxSolutions=n.maxSolutions||1,this.travelType=n.travelType,this.edgeWeight=n.edgeWeight,this.maxEdgeWeight=n.maxEdgeWeight,this.statisticGroupId=n.statisticGroup,n.statistic instanceof Number||"number"==typeof n.statistic?this.statisticId=+n.statistic:this.statisticId=n.statistic.id;var r={};i.forEach(function(t){r[t.id]={id:t.id,x:t.lng,y:t.lat}}),this.sources.push(r)},U=function(t){this.raw=t,this.id=t.id,this.maxPossibleValue=t.maxPossibleValue,this.solutions=t.simulationResults.map(function(t){var e={};return t.sourcePoints.forEach(function(t){e[t.id]=t.optimal}),{id:t.id,startTime:t.startTime,endTime:t.endTime,maxValue:t.maxValue,numberOfDesiredPoints:t.numberOfDesiredPoints,sources:e}})},E=function(){function e(t){this.client=t}return e.prototype.create=function(e,i){return s(this,void 0,void 0,function(){var n,r,s;return o(this,function(o){switch(o.label){case 0:return e.length?(n=t.UrlUtil.buildTargomoUrl(this.client.config.statisticsUrl,"simulation/start",this.client.serviceKey,!1)+"&serviceUrl="+encodeURIComponent(this.client.serviceUrl),r=new w(this.client.serviceUrl,this.client.serviceKey,e,i),[4,f(this.client).fetch(n,"POST",r)]):[2,null];case 1:return[2,(s=o.sent())&&+s.id]}})})},e.prototype.ready=function(e){return s(this,void 0,void 0,function(){var i;return o(this,function(n){return e instanceof Array||(e=[e]),i=t.UrlUtil.buildTargomoUrl(this.client.config.statisticsUrl,"simulation/ready",this.client.serviceKey,!1)+"&serviceUrl="+encodeURIComponent(this.client.serviceUrl)+e.map(function(t){return"&simulationId="+encodeURIComponent(""+ +t)}).join(""),[2,f(this.client).fetch(i)]})})},e.prototype.fetch=function(e){return s(this,void 0,void 0,function(){var i,n;return o(this,function(r){switch(r.label){case 0:return i=t.UrlUtil.buildTargomoUrl(this.client.config.statisticsUrl,"simulation/"+e,this.client.serviceKey,!1)+"&serviceUrl="+encodeURIComponent(this.client.serviceUrl),n=U.bind,[4,f(this.client).fetch(i)];case 1:return[2,new(n.apply(U,[void 0,r.sent()]))]}})})},e}(),C=function(t){function e(e,i,n){var r=t.call(this,n)||this;return r.osmTypes=[],r.sources=r.buildSourcesCfg([i]),r.osmTypes=n.osmTypes,r.format=n.format,r.serviceKey=e.serviceKey,r.serviceUrl=e.serviceUrl,r}return n(e,t),e}(b),R=function(){function t(t,e,i,n){this.id=t,this.lng=e,this.lat=i,this.properties=n,this.properties&&(this.properties["marker-size"]=1)}return t.prototype.toString=function(){return this.properties?this.properties.name:""},t.prototype.copy=function(){var e=new t(this.id,this.lat,this.lng,r({},this.properties));for(var i in this)"properties"!=i&&(e[i]=this[i]);return e},t}();function O(t){var e=t.lat,i=t.lon;return void 0===e&&t.center&&(e=t.center.lat,i=t.center.lon),new R(t.id,i,e,t.tags)}var I,A=function(){function t(t){this.client=t}return t.prototype.queryRaw=function(t){return s(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,f(this.client).fetch(this.client.config.overpassUrl+"/api/interpreter","POST-RAW",t)];case 1:return[2,e.sent().elements.filter(function(t){return!!t.tags}).map(function(t){return O(t)})]}})})},t.prototype.query=function(t,e){function i(t){if("*"===t.tag||null==t.tag)return'"'+t.type+'"';if(t.type&&t.tag)return'"'+t.type+'"="'+t.tag+'"';throw new Error("invalid query"+JSON.stringify(t))}var n=[];t.forEach(function(t){e.forEach(function(e){n.push("\n      way["+i(t)+"]\n        ("+e.southWest.lat+","+e.southWest.lng+","+e.northEast.lat+","+e.northEast.lng+");\n      node["+i(t)+"]\n        ("+e.southWest.lat+","+e.southWest.lng+","+e.northEast.lat+","+e.northEast.lng+");\n        ")})});var r="\n      [out:json];\n      (\n      "+n.join("")+"\n      );\n      out center;\n    ";return this.queryRaw(r)},t.prototype.queryGetCustom=function(t){return s(this,void 0,void 0,function(){return o(this,function(e){switch(e.label){case 0:return[4,f(this.client).fetch(t)];case 1:return[2,e.sent().elements.map(function(t){return O(t)})]}})})},t.prototype.reachable=function(t,e){return s(this,void 0,void 0,function(){var i;return o(this,function(n){switch(n.label){case 0:return i=this.client.config.poiUrl+"/reachability",[4,f(this.client).fetch(i,"POST",new C(this.client,t,e))];case 1:return[2,n.sent()]}})})},t}();(I=t.StatisticsGroups||(t.StatisticsGroups={}))[I.GERMANY_ZENSUS_100M_STATISTICS=9]="GERMANY_ZENSUS_100M_STATISTICS",I[I.GERMANY_ZENSUS_200M_STATISTICS=2]="GERMANY_ZENSUS_200M_STATISTICS",I[I.GERMANY_ZENSUS_500M_STATISTICS=11]="GERMANY_ZENSUS_500M_STATISTICS",I[I.GERMANY_ZENSUS_1000M_STATISTICS=3]="GERMANY_ZENSUS_1000M_STATISTICS",I[I.GERMANY_ZENSUS_2000M_STATISTICS=10]="GERMANY_ZENSUS_2000M_STATISTICS",I[I.NORWAY_STATISTICS=4]="NORWAY_STATISTICS",I[I.CENSUS_BRANDENBURG_POPULATION=12]="CENSUS_BRANDENBURG_POPULATION",I[I.CANADA_BLOCK_STATISTICS=8]="CANADA_BLOCK_STATISTICS",I[I.CANADA_AREA_STATISTICS=5]="CANADA_AREA_STATISTICS",I[I.BERLIN_STATISTICS=6]="BERLIN_STATISTICS";var _,x,P,M=function(t){for(var e in this.values=t,this.total=0,this.values)this.total+=this.values[e]};(_=t.SRID||(t.SRID={}))[_.SRID_3857=3857]="SRID_3857",_[_.SRID_4326=4326]="SRID_4326",(x=t.MultigraphRequestAggregation||(t.MultigraphRequestAggregation={})).NONE="none",x.SUM="sum",x.MAX="max",x.MIN="min",x.MEAN="mean",x.MEDIAN="median",x.NEAREST="nearest",x.UNION="routing_union",(P=t.MultigraphRequestLayer||(t.MultigraphRequestLayer={})).EDGE="edge",P.NODE="node",P.TILE="tile",P.HEXAGON="hexagon",P.TILE_NODE="tile_node",P.HEXAGON_NODE="hexagon_node";var N=new(function(){function t(){this.R=6378137}return t.prototype.project=function(t){var e=Math.PI/180,i=Math.max(Math.min(Math.sin(t.lat*e),1-1e-15),-(1-1e-15));return{x:this.R*t.lng*e,y:this.R*Math.log((1+i)/(1-i))/2}},t.prototype.unproject=function(t){var e=180/Math.PI;return{lat:(2*Math.atan(Math.exp(t.y/this.R))-Math.PI/2)*e,lng:t.x*e/this.R}},t}()),D=6371.01,G=Math.PI/180;function W(t,e){var i=G*t.lat,n=G*t.lng,r=G*e.lat,s=G*e.lng;return Math.acos(Math.sin(i)*Math.sin(r)+Math.cos(i)*Math.cos(r)*Math.cos(n-s))*D}function k(t,e){e*=1e3;var i=t.lat,n=t.lng,r=i*G,s=e/1e3/110.574235,o=e/1e3/(110.572833*Math.cos(r));return{northEast:{lat:i+s,lng:n+o},southWest:{lat:i-s,lng:n-o}}}function B(t){switch(t.travelType){case"walk":return 10;case"bike":return 25;case"transit":return 150;default:return 120}}function j(t,e,i){return e instanceof Array?F(t,e,i).filter(function(t){return!e.some(function(e){return e==t})}):F(t,e,i).filter(function(t){return e!=t})}function F(t,e,i){return e instanceof Array?t.filter(function(t){return e.some(function(e){return W(t,e)<=i})}):t.filter(function(t){return W(t,e)<=i})}function L(t,e){var i=N.unproject(t);return null!=e?{lat:i.lat,lng:i.lng,elevation:e}:i}var K,H=Object.freeze({contains:function(t,e){return e.lat>=t.southWest.lat&&e.lat<=t.northEast.lat&&e.lng>=t.southWest.lng&&e.lng<=t.northEast.lng},calculateDistance:W,boundingBox:k,locationsWithinTravelOptions:function(t,e,i){var n,r=i.maxEdgeWeight;switch(i.travelType){case"walk":n=10;break;case"bike":n=25;break;case"transit":n=150;break;default:n=120}return j(t,e,"distance"===i.edgeWeight?Math.round(r/1e3):n*r/3600)},boundingBoxWithinTravelOptions:function(t,e){var i=e.maxEdgeWeight,n=B(e);return k(t,"distance"===e.edgeWeight?Math.round(i/1e3):n*i/3600)},boundingBoxFromLocationArray:function(t){return t.reduce(function(t,e){return t.northEast.lat=e.lat>t.northEast.lat?e.lat:t.northEast.lat,t.northEast.lng=e.lng>t.northEast.lng?e.lng:t.northEast.lng,t.southWest.lat=e.lat<t.southWest.lat?e.lat:t.southWest.lat,t.southWest.lng=e.lng<t.southWest.lng?e.lng:t.southWest.lng,t},{northEast:{lat:t[0].lat,lng:t[0].lng},southWest:{lat:t[0].lat,lng:t[0].lng}})},boundingBoxListWithinTravelOptions:function(t,e){var i=e.maxEdgeWeight,n=B(e),r="distance"===e.edgeWeight?Math.round(i/1e3):n*i/3600,s={northEast:{lat:-1/0,lng:-1/0},southWest:{lat:1/0,lng:1/0}};return t.forEach(function(t){var e=k(t,r);s.northEast.lat=Math.max(s.northEast.lat,e.northEast.lat),s.northEast.lng=Math.max(s.northEast.lng,e.northEast.lng),s.southWest.lat=Math.min(s.southWest.lat,e.southWest.lat),s.southWest.lng=Math.min(s.southWest.lng,e.southWest.lng)}),s},locationsWithinDistance:j,locationsWithinDistanceInclusive:F,webMercatorToLatLng:L,latLngToWebMercator:function(t){return N.project(t)}}),q=function(t,e){var i=this;this.points=[],this.type=e.type,this.travelTime=e.travelTime,this.distance=e.length/1e3,this.warning=e.warning,this.elevationGain=e.elevationGain,this.transitSegment=!1,this.startName=e.startname,this.endName=e.endname,e.points.forEach(function(t){i.points.push(L({x:t[1],y:t[0]},t[2]))}),e.isTransit&&(this.transitSegment=!0,this.routeType=e.routeType,this.routeShortName=e.routeShortName,this.startName=e.startname,this.endName=e.endname,this.departureTime=e.departureTime,this.arrivalTime=e.arrivalTime,this.tripHeadSign=e.tripHeadSign)},z=function(){function t(t,e,i,n){var r=this;this.travelTime=e,this.routeSegments=[],this.targetHeight=void 0,this.sourceHeight=void 0,this.sourceId=void 0,this.targetId=void 0,this.length=void 0;var s=0,o=[];i.reverse().forEach(function(e){var i=new q(t,e);r.routeSegments.push(i),"TRANSFER"===i.type&&s++,o=o.concat(i.points.reverse())}),this.points=o,this.transfers=s,void 0!==n&&(this.sourceId=n.source_id,this.targetId=n.target_id,this.length=n.length);var a=this.calculateElevationDifferences(this.points);this.targetHeight=a.targetHeight,this.sourceHeight=a.sourceHeight,this.uphillMeter=a.uphillMeter,this.downhillMeter=a.downhillMeter,this.totalElevationDifference=Math.abs(this.sourceHeight-this.targetHeight),this.departureTime=this.calculateDepartureTime(),this.arrivalTime=this.calculateArrivalTime(),this.distance=this.calculateDistance(),this.elevationGain=this.calculateElevationGain()}return t.prototype.calculateDistance=function(){for(var t=0,e=0;e<this.routeSegments.length;e++)t+=this.routeSegments[e].distance;return t},t.prototype.calculateElevationGain=function(){for(var t=void 0,e=0;e<this.routeSegments.length;e++)isFinite(this.routeSegments[e].elevationGain)&&(t=(t||0)+this.routeSegments[e].elevationGain);return t},t.prototype.calculateElevationDifferences=function(t){for(var e=void 0,i=void 0,n=void 0,r=0,s=0,o=this.points.length-1;0<=o;o--)0==o&&(i=this.points[o].elevation),o==this.points.length-1&&(n=this.points[o].elevation),void 0!==e&&(e>this.points[o].elevation?r+=e-this.points[o].elevation:e<this.points[o].elevation&&(s+=this.points[o].elevation-e)),e=this.points[o].elevation;return{targetHeight:i,sourceHeight:n,uphillMeter:r,downhillMeter:s}},t.prototype.calculateDepartureTime=function(){for(var t=0,e=0;e<this.routeSegments.length;e++){var i=this.routeSegments[e];if(null!=i.departureTime)return i.departureTime-t;t+=i.travelTime||0}},t.prototype.calculateArrivalTime=function(){for(var t=0,e=this.routeSegments.length-1;0<=e;e--){var i=this.routeSegments[e];if(null!=i.arrivalTime)return i.arrivalTime-t;t+=i.travelTime||0}},t}(),V=function(t,e){function i(t){for(var i={},n=0,r=e;n<r.length;n++){var s=r[n];i[s.name]=new M(t[s.id])}return i}var n={};if(t.individualStatistics)for(var r in t.individualStatistics)t.individualStatistics[r]&&t.individualStatistics[r].statistics&&(n[r]=i(t.individualStatistics[r].statistics));this.statistics=i(t.statistics),this.individualStatistics=n,this.raw=t};(K=t.MultigraphStatus||(t.MultigraphStatus={})).CREATED="CREATED",K.ROUTING="ROUTING",K.MERGING="MERGING",K.AGGREGATING="AGGREGATING",K.COMPLETED="COMPLETED",K.FAILED="FAILED";var J=function(t,e){this.values={};var i={};e.forEach(function(t){i[t.id]=t.name}),this.raw=t;var n=this.values;for(var r in t){var s=t[r],o=(s.aggregation||"").toLowerCase();n[o]=n[o]||{};var a=i[s.statisticId];n[o][a]={value:s.value}}},Y=function(){this.minPolygonHoleSize=1e7,this.buffer=50,this.simplify=50,this.srid=t.SRID.SRID_4326,this.quadrantSegments=2,this.intersectionMode="union",this.decimalPrecision=6},Z=function(t){function e(e,i,n){var r=t.call(this,n)||this;return r.polygon=new Y,r.sources=r.buildSourcesCfg(i),r.polygon.values=n.travelEdgeWeights,r.polygon.serializer=n.serializer,r.polygon.simplify=n.simplify,r.polygon.srid=n.srid,r.polygon.buffer=n.buffer,r.polygon.minPolygonHoleSize=n.minPolygonHoleSize,r.polygon.quadrantSegments=n.quadrantSegments,r.polygon.intersectionMode=n.intersectionMode,r.polygon.decimalPrecision=n.decimalPrecision,r}return n(e,t),e}(b),X=function(){function e(t){this.client=t}return e.prototype.fetch=function(t,e){return s(this,void 0,void 0,function(){var i,n;return o(this,function(r){switch(r.label){case 0:return i=new Z(this.client,t,e),[4,this._executeFetch(t,e,i)];case 1:return n=r.sent(),"json"===e.serializer?[2,n]:"geojson"===e.serializer?[2,n]:[2]}})})},e.prototype._executeFetch=function(e,i,n){return s(this,void 0,void 0,function(){var e,r;return o(this,function(s){switch(s.label){case 0:return e=t.UrlUtil.buildTargomoUrl(this.client.serviceUrl,"polygon",this.client.serviceKey),[4,f(this.client).fetchCachedData(i.useClientCache,e,"POST",n)];case 1:return(r=s.sent()).metadata=i,[2,r]}})})},e}(),$=function(t){function e(e,i,n,r){var s=t.call(this,r)||this;return s.sources=s.buildSourcesCfg(i),s.targets=s.buildTargetsCfg(n),s}return n(e,t),e}(b),Q=function(){function e(t){this.client=t}return e.prototype.individual=function(e,i,n){return s(this,void 0,void 0,function(){var r,s;return o(this,function(o){switch(o.label){case 0:return r=t.UrlUtil.buildTargomoUrl(this.client.serviceUrl,"time",this.client.serviceKey),s=new $(this.client,e,i,n),[4,f(this.client).fetchCachedData(n.useClientCache,r,"POST",s)];case 1:return[2,o.sent()]}})})},e.prototype.combined=function(e,i,n){return s(this,void 0,void 0,function(){var r,s;return o(this,function(o){switch(o.label){case 0:return r=t.UrlUtil.buildTargomoUrl(this.client.serviceUrl,"reachability",this.client.serviceKey),s=new $(this.client,e,i,n),[4,f(this.client).fetchCachedData(n.useClientCache,r,"POST",s)];case 1:return[2,o.sent()]}})})},e.prototype.count=function(t,e,i){return s(this,void 0,void 0,function(){return o(this,function(n){switch(n.label){case 0:return[4,this.locations(t,e,i)];case 1:return[2,n.sent().length]}})})},e.prototype.locations=function(t,e,i){return s(this,void 0,void 0,function(){var n;return o(this,function(r){switch(r.label){case 0:return n={},e.forEach(function(t){return n[String(t.id)]=-1}),[4,this.combined(t,e,i)];case 1:return r.sent().forEach(function(t){var e=String(t.id);n[e]?-1<t.travelTime&&(-1<n[e]?n[e]=Math.min(n[e],t.travelTime):n[e]=t.travelTime):console.warn("NOT FOUND",String(t.id))}),[2,e.filter(function(t){var e=String(t.id);return t.travelTime=n[e],-1<n[e]})]}})})},e}(),tt=function(t){function e(e,i,n,r){var s=t.call(this,r)||this;return s.sources=s.buildSourcesCfg(i),s.targets=s.buildTargetsCfg(n),s.pathSerializer=r.pathSerializer,"boolean"==typeof r.recommendations&&(r.recommendations=r.recommendations?1:0),Number.isInteger(r.recommendations)&&s.sources&&s.sources.forEach(function(t){if(null!=t.tm)for(var e in t.tm)t.tm[e].recommendations=r.recommendations}),s}return n(e,t),e}(b),et=function(){function e(t){this.client=t}return e.prototype.fetch=function(e,i,n){return s(this,void 0,void 0,function(){var r,s,a,c=this;return o(this,function(o){switch(o.label){case 0:return r=new tt(this.client,e,i,n),s=t.UrlUtil.buildTargomoUrl(this.client.serviceUrl,"route",this.client.serviceKey)+"&cfg="+encodeURIComponent(JSON.stringify(r)),[4,f(this.client).fetchCachedData(n.useClientCache,s,"GET",void 0,{Accept:"application/json,application/javascript,*/*"})];case 1:return(a=o.sent()).routes?[2,a.routes.map(function(t){return new z(c.client,t.travelTime,t.segments,t)})]:[2,null]}})})},e}(),it=function(){function t(t){this.client=t}return t.prototype.metadata=function(t){return s(this,void 0,void 0,function(){var e;return o(this,function(i){switch(i.label){case 0:return e=this.client.config.tilesUrl+"/similarity/meta/v1/"+encodeURIComponent(""+t)+"?key="+encodeURIComponent(this.client.serviceKey),[4,f(this.client).fetch(e)];case 1:return[2,i.sent()]}})})},t.prototype.fetch=function(t,e,i,n,r){return s(this,void 0,void 0,function(){var s,a,c,u;return o(this,function(o){switch(o.label){case 0:return s={west:n.southWest.lng,south:n.southWest.lat,east:n.northEast.lng,north:n.northEast.lat},a={bounds:s,refCellId:e,scores:i.map(function(t){return{source:t.source,minutes:t.minutes,factor:t.factor||1}})},c=(r?"?normalizeOnViewport="+!!r+"&":"?")+"?key="+encodeURIComponent(this.client.serviceKey),u=this.client.config.tilesUrl+"/similarity/scores_cumulative/v1/"+encodeURIComponent(""+t)+c,[4,f(this.client).fetch(u,"POST",a)];case 1:return[2,o.sent()]}})})},t}(),nt=function(t,e,i){this.inactiveSources=[],this.getClosestSources=!1,this.serviceUrl=t.serviceUrl,this.serviceKey=t.serviceKey,this.useCache=null==i.useCache||i.useCache,this.sources=e.map(function(t){return{id:t.id,y:t.lat,x:t.lng}}),this.iFeelLucky=i.iFeelLucky,this.travelType=i.travelType,this.edgeWeight=i.edgeWeight,this.maxEdgeWeight=i.maxEdgeWeight,i.inactiveSources&&(this.inactiveSources=i.inactiveSources.map(function(t){return{id:t.id,y:t.lat,x:t.lng}}));var n=[];i.statistics&&(this.omitIndividualStatistics=i.omitIndividualStatistics,n=i.statistics.map(function(t){return t instanceof Number||"number"==typeof t?+t:t.id})),this.statisticGroupId=+i.statisticsGroup,this.statisticIds=n,i.closestSources&&(this.getClosestSources=!0)},rt=function(t,e,i){var n=i.statistics.map(function(t){return t instanceof Number||"number"==typeof t?+t:t.id});this.statisticGroupId=+i.statisticsGroup,this.statisticIds=n,this.intersectionGeometry={data:e,crs:i.crs||4326}},st=function(){function t(t){this.client=t,this.statisticsMetadataCache=new c(200),this.statisticsEnsemblesCache=new c(200)}return t.prototype.combined=function(t,e){return s(this,void 0,void 0,function(){var i;return o(this,function(n){switch(n.label){case 0:return[4,this.dependent(t,e)];case 1:return[2,(i=n.sent())&&i.statistics]}})})},t.prototype.individual=function(t,e){return s(this,void 0,void 0,function(){var i;return o(this,function(n){switch(n.label){case 0:return[4,this.dependent(t,e)];case 1:return[2,(i=n.sent())&&i.individualStatistics]}})})},t.prototype.travelTimes=function(t,e){return s(this,void 0,void 0,function(){var i;return o(this,function(n){switch(n.label){case 0:return t.length?(i=this.client.config.statisticsUrl+"/traveltimes?serviceUrl="+encodeURIComponent(this.client.serviceUrl),[4,f(this.client).fetch(i,"POST",new nt(this.client,t,e))]):[2,null];case 1:return[2,n.sent()]}})})},t.prototype.dependent=function(t,e){return s(this,void 0,void 0,function(){var i,n;return o(this,function(r){switch(r.label){case 0:return t.length?(i=this.client.config.statisticsUrl+"/charts/dependent?serviceUrl="+encodeURIComponent(this.client.serviceUrl),[4,f(this.client).fetch(i,"POST",new nt(this.client,t,e))]):[2,null];case 1:return n=r.sent(),[2,new V(n,e.statistics)]}})})},t.prototype.geometry=function(t,e){return s(this,void 0,void 0,function(){var i,n;return o(this,function(r){switch(r.label){case 0:return t?(i=this.client.config.statisticsUrl+"/values/geometry?serviceUrl="+encodeURIComponent(this.client.serviceUrl),[4,f(this.client).fetch(i,"POST",new rt(this.client,t,e))]):[2,null];case 1:return n=r.sent(),[2,new J(n,e.statistics)]}})})},t.prototype.metadata=function(t){return s(this,void 0,void 0,function(){var e,i,n,r=this;return o(this,function(a){switch(a.label){case 0:return e=this.client.config.tilesUrl,i="number"==typeof t?t:t.id,n=e+"-"+i,[4,this.statisticsMetadataCache.get(n,function(){return s(r,void 0,void 0,function(){var t;return o(this,function(n){switch(n.label){case 0:return[4,f(this.client).fetch(e+"/statistics/meta/v1/"+i+"?key="+encodeURIComponent(this.client.serviceKey))];case 1:return!(t=n.sent()).name&&t.names&&t.names.en&&(t.name=t.names.en),t.stats&&t.stats.length&&t.stats.forEach(function(t){!t.name&&t.names&&t.names.en&&(t.name=t.names.en)}),[2,t]}})})})];case 1:return[2,a.sent()]}})})},t.prototype.metadataKey=function(t,e){return s(this,void 0,void 0,function(){var i,n,r,s;return o(this,function(o){switch(o.label){case 0:return[4,this.metadata(t)];case 1:for(i=o.sent(),n=0,r=i.stats;n<r.length;n++)if(s=r[n],e.id==s.statistic_id||s.names&&s.names.en==e.name)return[2,s];return[2,null]}})})},t.prototype.tileRoute=function(t,e){var i=this.client.config.tilesUrl,n="number"==typeof t?t:t.id,r="";return e&&0<e.length&&(r="columns="+encodeURIComponent(e.map(function(t){return+t.id}).join(","))+"&"),i+"/statistics/tiles/v1/"+n+"/{z}/{x}/{y}.mvt?"+r+"key="+encodeURIComponent(this.client.serviceKey)},t.prototype.ensembles=function(){return s(this,void 0,void 0,function(){var t,e=this;return o(this,function(i){switch(i.label){case 0:return t=this.client.config.tilesUrl,[4,this.statisticsEnsemblesCache.get(t,function(){return s(e,void 0,void 0,function(){var t,e,i,n;return o(this,function(r){switch(r.label){case 0:return t=this.client.config.tilesUrl+"/ensemble/list/v1?key="+encodeURIComponent(this.client.serviceKey),[4,f(this.client).fetch(t,"GET")];case 1:for(i in e=r.sent())e[i]&&((n=e[i]).id=+n.id,n.groups&&n.groups.length&&n.groups.forEach(function(t){t.hierarchy=+t.hierarchy,t.id=+t.id}));return[2,e]}})})})];case 1:return[2,i.sent()]}})})},t}(),ot=function(t){function e(e,i,n){var r=t.call(this,e,i,n)||this;return delete r.inactiveSources,delete r.statisticGroupId,delete r.statisticIds,delete r.getClosestSources,delete r.useCache,n&&(r.multiGraphSerializationType=n.multigraph.serialization.format,r.multiGraphSerializationDecimalPrecision=n.multigraph.serialization.decimalPrecision,n.multigraph.aggregation&&(r.multiGraphAggregationType=n.multigraph.aggregation.type||null,r.multiGraphAggregationIgnoreOutlier=n.multigraph.aggregation.ignoreOutliers||null,r.multiGraphAggregationMinSourcesRatio=n.multigraph.aggregation.minSourcesRatio||null,r.multiGraphAggregationMinSourcesCount=n.multigraph.aggregation.minSourceCount||null,r.multiGraphAggregationMaxResultValueRatio=n.multigraph.aggregation.maxResultValueRatio||null,r.multiGraphAggregationMaxResultValue=n.multigraph.aggregation.maxResultValue||null)),r}return n(e,t),e}(nt),at=function(){function e(t){this.client=t}return e.prototype.create=function(e,i){return s(this,void 0,void 0,function(){var n,r;return o(this,function(s){switch(s.label){case 0:return n=t.UrlUtil.buildTargomoUrl(this.client.config.statisticsUrl,"multigraph",this.client.serviceKey,!1),r=new ot(this.client,e,i),[4,f(this.client).fetchCachedData(i.useClientCache,n,"POST",r,{Accept:"text/plain"})];case 1:return[2,s.sent()]}})})},e.prototype.info=function(e){return s(this,void 0,void 0,function(){var i,n;return o(this,function(r){switch(r.label){case 0:return i=t.UrlUtil.buildTargomoUrl(this.client.config.statisticsUrl,"multigraph/"+e,this.client.serviceKey,!1),[4,f(this.client).fetch(i,"GET")];case 1:return(n=r.sent()).boundingBoxNorthEast&&n.boundingBoxSouthWest&&(n.boundingBox={northEast:{lat:n.boundingBoxNorthEast.y,lng:n.boundingBoxNorthEast.x},southWest:{lat:n.boundingBoxSouthWest.y,lng:n.boundingBoxSouthWest.x}},delete n.boundingBoxNorthEast,delete n.boundingBoxSouthWest),[2,n]}})})},e.prototype.redo=function(e){return s(this,void 0,void 0,function(){var i;return o(this,function(n){switch(n.label){case 0:return i=t.UrlUtil.buildTargomoUrl(this.client.config.statisticsUrl,"multigraph/"+e+"/update",this.client.serviceKey,!1),[4,f(this.client).fetch(i,"PATCH")];case 1:return[2,n.sent()]}})})},e}(),ct=function(){function e(t){this.client=t}return e.prototype.fetch=function(e,i,n,r){return s(this,void 0,void 0,function(){var s,a;return o(this,function(o){switch(o.label){case 0:return s=t.UrlUtil.buildTargomoUrl(this.client.config.fleetsUrl,"api/key-auth/optimizations",this.client.serviceKey,!0),a=this._createPayload(this.client,e,i,n,r),[4,f(this.client).fetch(s,"POST",a)];case 1:return[2,o.sent()]}})})},e.prototype._createPayload=function(t,e,i,n,r){return{optimizationTime:r.optimizationTime,optimizationAlgorithm:r.optimizationAlgorithm,optimizationMetadata:{costMatrixSource:r.costMatrixSource,geojsonCreation:r.geojsonCreation,unimprovedWaitingTime:r.unimprovedWaitingTime,filterOrdersWithMissedDeadline:r.filterOrdersWithMissedDeadline,filterOrdersOutsideOfValidWorkingHours:r.filterOrdersOutsideOfValidWorkingHours,prohibitFilteringOfOrdersWithDeadlinesEarlierEqualsThan:r.prohibitFilteringOfOrdersWithDeadlinesEarlierEqualsThan,secondsToPenaltyRatioForDeadlineMissed:r.secondsToPenaltyRatioForDeadlineMissed,secondsToPenaltyRatioForOutOfWorkingHours:r.secondsToPenaltyRatioForOutOfWorkingHours,timeConstraintPenaltyToTravelCostRatio:r.timeConstraintPenaltyToTravelCostRatio,longestTourPenaltyFactor:r.longestTourPenaltyFactor,nonParallelOrdersByTags:r.nonParallelOrdersByTags,travelOptions:{travelType:r.travelType,serviceKey:t.serviceKey,serviceUrl:t.serviceUrl,travelTimeFactors:r.travelTimeFactors,fallbackServiceUrl:"",edgeWeight:r.edgeWeight,maxEdgeWeight:r.maxEdgeWeight,elevationEnabled:r.elevation,rushHour:r.rushHour}},stores:e,transports:n,orders:i}},e}(),ut=function(){function t(t){this.client=t,this.basemapsLookup={Bright:"osm-bright-gl-style",Light:"positron-gl-style","Light No-Labels":"positron-nolabels-gl-style",Dark:"dark-matter-gl-style","Dark No-Labels":"dark-matter-nolabels-gl-style",Gray:"gray-gl-style","Gray No-Labels":"gray-nolabels-gl-style","Light blue":"blueberry-gl-style","Dark blue":"fiord-color-gl-style","Dark blue No-Labels":"fiord-color-nolabels-gl-style",Basic:"klokantech-basic-gl-style",Toner:"toner-gl-style"}}return Object.defineProperty(t.prototype,"basemapNames",{get:function(){return Object.keys(this.basemapsLookup)},enumerable:!0,configurable:!0}),t.prototype.getGLStyleURL=function(t){if(!t||!this.basemapsLookup[t])throw new Error("valid style name required to access Targomo basemap");return"https://maps.targomo.com/styles/"+this.basemapsLookup[t]+".json?key="+this.client.serviceKey},t}(),lt=function(t,e){this.esri=t,this.photon=e},ht=function(){function t(t,i,n){if(this.serviceKey=i,!t)throw new TypeError("Region parameter is missing");this.config=new e(n),t.includes("http")||t.includes("localhost")||t.includes("/")?this.serviceUrl=t:this.serviceUrl="https://api.targomo.com/"+t+"/",this.pois=new A(this),this.statistics=new st(this),this.reachability=new Q(this),this.optimizations=new E(this),this.geocoding=new lt(new g,new m(this)),this.polygons=new X(this),this.routes=new et(this),this.similarity=new it(this),this.benchmarks=new p(this),this.statefulMultigraph=new at(this),this.multigraph=new S(this),this.basemaps=new ut(this),this.fleets=new ct(this)}return Object.defineProperty(t.prototype,"endpoint",{get:function(){var t=this.serviceUrl.split("/").filter(function(t){return!!t});return t[t.length-1]},enumerable:!0,configurable:!0}),t.prototype.metadata=function(){return s(this,void 0,void 0,function(){var t,e,i;return o(this,function(n){switch(n.label){case 0:return t=this.endpoint,e=this.serviceKey,i=this.config.serverUrl+"/"+t+"/v1/metadata/network?key="+encodeURIComponent(e),[4,f().fetch(i)];case 1:return[2,n.sent()]}})})},t}(),ft=H;t.geometry=ft,t.PointsOfInterestClient=A,t.ClientConfig=e,t.BenchmarksClient=p,t.GeocodeEsriClient=g,t.GeocodePhotonClient=m,t.MultigraphClient=S,t.OptimizationsClient=E,t.PolygonsClient=X,t.ReachabilityClient=Q,t.RoutesClient=et,t.SimilarityClient=it,t.StatisticsClient=st,t.GeocodingClients=lt,t.TargomoClient=ht,t.FleetsClient=ct,t.LatLng=function(){},t.BoundingBox=function(){},t.TravelSpeedValues=function(){},t.StatisticValues=M,t.UseCacheRequestOptions=function(){},t.BaseRequestOptions=v,t.TravelRequestOptions=y,t.Route=z,t.RouteSegment=q,t.StatisticsResult=V,t.FpResult=function(){},t.OptimizationResult=U,t.StatisticsGeometryResult=J,t.RequestsUtil=h,t.requests=f,t.SimpleLRU=c,t.SimpleCache=u,Object.defineProperty(t,"__esModule",{value:!0})}(e)}]);
//# sourceMappingURL=targomo-core-prod.js.map